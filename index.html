<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Pot Ã  MÃ¨che â€“ Orientation</title>

  <!-- PWA -->
  <link rel="manifest" href="./manifest.json">
  <meta name="theme-color" content="#ffffff">

  <!-- IcÃ´ne -->
  <link rel="icon" href="./icon_4_compass.png">

  <!-- Styles -->
  <link rel="stylesheet" href="./style.css">
</head>

<body>

<header class="topbar">
  <div class="top-left">
    <img src="./icon_4_compass.png" class="top-logo" alt="logo">
    <button onclick="openHelpPopup()" data-i18n="help">Aide</button>
  </div>

  <div class="top-title" data-i18n="app_title">
    Pot Ã  MÃ¨che
  </div>

  <div class="top-right">
    <div class="author">B. Barrois</div>
    <div class="top-right-sub">
      <button id="btnMail" title="Contact">âœ‰ï¸</button>
      <span id="version">v. : x.x</span>
    </div>
  </div>
</header>

<div class="top-actions">
  <button id="btnCapt" class="btn-capt" data-i18n="capture">
    Capture dâ€™Ã©cran
  </button>

  <div id="dateTime" class="date-time"></div>

  <button id="btnLoc" class="btn-loc" data-i18n="nest_location">
    Localisation du nid
  </button>
</div>

<div class="lang-bar">
  <button data-lang="fr">ğŸ‡«ğŸ‡·</button>
  <button data-lang="en">ğŸ‡¬ğŸ‡§</button>
  <button data-lang="de">ğŸ‡©ğŸ‡ª</button>
  <button data-lang="it">ğŸ‡®ğŸ‡¹</button>
  <button data-lang="es">ğŸ‡ªğŸ‡¸</button>
  <button data-lang="nl">ğŸ‡³ğŸ‡±</button>
</div>

<main id="observations"></main>

<script src="./version.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const v = document.getElementById("version");
  if (v && typeof APP_VERSION !== "undefined") {
    v.textContent = "v. : " + APP_VERSION;
  }
});
</script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const el = document.getElementById("dateTime");
  function update() {
    const n = new Date();
    el.textContent =
      n.toLocaleDateString("fr-FR") + " " +
      n.toLocaleTimeString("fr-FR", { hour:"2-digit", minute:"2-digit", second:"2-digit" });
  }
  update();
  setInterval(update, 1000);
});
</script>

<script src="./js/i18n.js"></script>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
document.getElementById("btnCapt").onclick = async () => {
  const canvas = await html2canvas(document.body, { scale: 2 });
  const blob = await new Promise(r => canvas.toBlob(r, "image/png"));
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "Pot_a_Meche.png";
  a.click();
};
</script>

<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script src="./js/supabase.js"></script>

<script src="./app.js"></script>
<script src="./js/help.js"></script>

<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("./service-worker.js");
}
</script>

</body>
</html>
